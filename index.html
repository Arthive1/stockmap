<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StockMap - 프리미엄 주식 검색</title>
    <meta name="description" content="실시간 주식 정보 및 S&P 500 종목 분석 플랫폼">
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Remix Icons -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
</head>

<body>
    <div class="background-effects">
        <div class="glow-orb orb-1"></div>
        <div class="glow-orb orb-2"></div>
    </div>

    <div class="app-container">
        <!-- Header / Search Section -->
        <header class="hero-section">
            <div class="logo">
                <i class="ri-stock-line logo-icon"></i>
                <span class="logo-text">StockMap</span>
            </div>

            <nav class="main-nav">
                <button class="nav-btn active" data-view="fundermentals">기본분석</button>
                <button class="nav-btn" data-view="tradeHistory">거래내역</button>
            </nav>

            <div class="header-content">
                <div class="title-container">
                    <h1>시장을 꿰뚫는 하나의 시선</h1>
                    <p>티커나 기업명을 검색하여 상세한 재무 정보를 확인하세요.</p>
                </div>

                <div class="search-container">
                    <div class="search-box">
                        <i class="ri-search-line search-icon"></i>
                        <input type="text" id="searchInput" placeholder="주식 티커 또는 기업명 검색 (예: AAPL, 애플)..."
                            autocomplete="off">
                    </div>
                </div>
            </div>
        </header>

        <!-- View: Fundermentals -->
        <div id="fundermentalsView">
            <!-- Recommendations Section -->
            <section class="recommendations-section" id="recommendationsSection">
                <h3 class="recommendations-title"><i class="ri-thumb-up-line"></i> 오늘의 매수 추천 후보군 (상위 6개)</h3>
                <div class="recommendation-cards-wrapper" id="recommendationsWrapper">
                    <!-- Market rows will be dynamically populated here -->
                </div>
            </section>

            <!-- Main Content Section -->
            <main class="main-content">
                <div class="section-header">
                    <div class="market-tabs">
                        <button class="tab-btn active" data-market="SP500">S&P 500</button>
                        <button class="tab-btn" data-market="NASDAQ">NASDAQ 300</button>
                        <button class="tab-btn" data-market="KOSPI">KOSPI 100</button>
                    </div>
                    <!-- <h2 class="section-title">주요 종목 분석</h2> -->
                    <div class="table-actions">
                        <div class="glossary-wrapper">
                            <button class="action-btn" id="glossaryBtn">
                                <i class="ri-information-line"></i> 용어 설명
                            </button>
                            <div class="glossary-box" id="glossaryBox">
                                <h3>용어 설명 (Glossary)</h3>
                                <ul>
                                    <li><strong>역사적 최고가:</strong> 주식이 상장된 이후 달성한 가장 높은 가격 (All-Time High, ATH)</li>
                                    <li><strong>최고가 이후 최저가:</strong> 역사적 최고가를 기록한 이후 하락하여 도달한 가장 낮은 가격</li>
                                    <li><strong>오늘 종가:</strong> 오늘 주식의 종가 (현재가)</li>
                                    <li><strong>조정 비율:</strong> 역사적 최고가 이후 가장 최저가까지의 주식 조정 비율 (하락폭)</li>
                                    <li><strong>종가/최고가 비율:</strong> 오늘 종가를 역사적 최고가로 나눈 값 (최고가에 얼마나 근접했는지 비율)</li>
                                    <li><strong>최고가 경과일:</strong> 역사적 최고가를 기록한 이후 오늘까지 경과한 일수</li>
                                    <li><strong>이격도 퍼센타일:</strong> 최근 1년간 각 일자의 (|10일선-50일선| + |20일선-50일선|) 값을 기준으로, 오늘
                                        수치가
                                        과거 1년 중 하위 몇 %에 위치하는지 나타내는 지표</li>
                                    <li><strong>EPS Q0 ~ Q-3:</strong> 분기별 EPS(주당순이익) 상승률 (Q0: 최근, Q-3: 3분기 전)</li>
                                    <li><strong>PER (Price-to-Earnings Ratio):</strong> 주가 수익 비율 (시가총액 / 순이익)</li>
                                    <li><strong>ROE (Return on Equity):</strong> 자기자본 이익률 (순이익 / 자기자본)</li>
                                </ul>
                            </div>
                        </div>
                        <button class="action-btn" id="downloadBtn"><i class="ri-download-line"></i> 다운로드</button>
                    </div>
                </div>

                <div class="table-container">
                    <table class="stock-table" id="stockTable">
                        <thead>
                            <tr>
                                <th class="sticky-col index-col">구분</th>
                                <th class="sticky-col sortable" data-sort="ticker">티커 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="name">기업명 <i
                                        class="ri-expand-up-down-line sort-icon"></i>
                                </th>
                                <th class="sortable" data-sort="ath">역사적 최고가 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="lowest_after_ath">최고가 이후 최저가 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="price">오늘 종가 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="correction_ratio">조정 비율 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="price_to_ath">종가/최고가 비율 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="days_since_ath">최고가 경과일 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="ma_spread_percentile">이동평균 이격도 <br>(하위 백분위수) <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="eps_q0">EPS Q0 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="eps_q1">EPS Q-1 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="eps_q2">EPS Q-2 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="eps_q3">EPS Q-3 <i
                                        class="ri-expand-up-down-line sort-icon"></i></th>
                                <th class="sortable" data-sort="per">PER <i
                                        class="ri-expand-up-down-line sort-icon"></i>
                                </th>
                                <th class="sortable" data-sort="roe">ROE <i
                                        class="ri-expand-up-down-line sort-icon"></i>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="stockTableBody">
                            <!-- Data will be populated here by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </main>
        </div>

        <!-- View: Trade History -->
        <div id="tradeHistoryView" style="display: none;">
            <div class="trade-history-container">
                <section class="trade-section" id="investmentSummarySection">
                    <h2 class="trade-section-title">투자결과</h2>
                    <div class="summary-stats">
                        <div class="summary-box">
                            <h3>평가금액</h3>
                            <div class="summary-values">
                                <div class="summary-item">
                                    <div class="summary-main">
                                        <span class="label">KRW</span>
                                        <span id="holdingEvalKRW" class="value">₩0</span>
                                    </div>
                                    <div id="holdingProfitKRW" class="summary-sub">
                                        +₩0 (0.00%)
                                    </div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-main">
                                        <span class="label">USD</span>
                                        <span id="holdingEvalUSD" class="value">$0</span>
                                    </div>
                                    <div id="holdingProfitUSD" class="summary-sub">
                                        +$0 (0.00%)
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="summary-box">
                            <h3>실현수익</h3>
                            <div class="summary-values">
                                <div class="summary-item">
                                    <div class="summary-main">
                                        <span class="label">KRW</span>
                                        <span id="totalProfitKRW" class="value">₩0</span>
                                    </div>
                                </div>
                                <div class="summary-item">
                                    <div class="summary-main">
                                        <span class="label">USD</span>
                                        <span id="totalProfitUSD" class="value">$0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="trade-section" id="tradeEntrySection">
                    <h2 class="trade-section-title">보유주식</h2>
                    <div class="table-container">
                        <table class="stock-table" id="entryTable">
                            <thead>
                                <tr>
                                    <th>티커</th>
                                    <th>매수일</th>
                                    <th>수량</th>
                                    <th>평단가</th>
                                    <th>합계</th>
                                    <th>오늘 주가</th>
                                    <th>평가금</th>
                                    <th>손익</th>
                                    <th>매도</th>
                                </tr>
                            </thead>
                            <tbody id="entryTableBody">
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>
                <section class="trade-section" id="tradeHistorySection">
                    <h2 class="trade-section-title">거래완료</h2>
                    <div class="table-container">
                        <table class="stock-table" id="historyTable">
                            <thead>
                                <tr>
                                    <th>티커</th>
                                    <th>매수일</th>
                                    <th>매도일</th>
                                    <th>수량</th>
                                    <th>매수평단</th>
                                    <th>매도평단</th>
                                    <th>수익</th>
                                    <th>수익률</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <!-- Data will be populated here -->
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Trade Entry Modal -->
    <div id="tradeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>매수 정보 입력</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="tradeForm">
                <div class="form-group">
                    <label for="modalTicker">티커</label>
                    <input type="text" id="modalTicker" readonly>
                </div>
                <div class="form-group">
                    <label for="modalDate">매수일</label>
                    <input type="date" id="modalDate" required>
                </div>
                <div class="form-group">
                    <label for="modalQuantity">매수량</label>
                    <input type="number" id="modalQuantity" min="1" step="1" required>
                </div>
                <div class="form-group">
                    <label for="modalPrice">매수가격</label>
                    <input type="number" id="modalPrice" min="0" step="0.01" required>
                </div>
                <button type="submit" class="submit-btn primary-btn">입력하기</button>
            </form>
        </div>
    </div>

    <!-- Trade Sell Modal -->
    <div id="sellModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>매도 정보 입력</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="sellForm">
                <div class="form-group">
                    <label for="sellTicker">티커</label>
                    <input type="text" id="sellTicker" readonly>
                </div>
                <div class="form-group">
                    <label for="sellDate">매도일</label>
                    <input type="date" id="sellDate" required>
                </div>
                <div class="form-group">
                    <label for="sellQuantity">매도수량 (보유: <span id="maxSellQty">0</span>)</label>
                    <input type="number" id="sellQuantity" min="1" step="1" required>
                </div>
                <div class="form-group">
                    <label for="sellPrice">매도평단가</label>
                    <input type="number" id="sellPrice" min="0" step="0.01" required>
                </div>
                <button type="submit" class="submit-btn secondary-btn" style="background: var(--negative-color);">매도
                    완료</button>
            </form>
        </div>
    </div>

    <script src="market_data.js"></script>
    <script src="script.js"></script>
</body>

</html>